<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>ally.when.key - ally.js</title><link rel="canonical" href="https://allyjs.io/api/when/key.html">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../assets/website.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.css" data-noprefix="">
</head>
<body>
  <a href="#main" class="skip-to-content">Skip to content</a>
  <header>
    <h1 id="logo">ally.js</h1>
    <p id="claim"><em>JavaScript</em> library to help modern <em>web applications</em> with <em>accessibility</em> concerns by <strong>making accessibility simpler</strong></p>
    <nav id="site-navigation">
      <ul>
          
            <li class="">
              <a href="../../index.html">Home</a>
            </li>
          
            <li class="">
              <a href="../../getting-started.html">Getting Started</a>
            </li>
          
            <li class="active">
              <a href="../index.html">API</a>
            </li>
          
            <li class="">
              <a href="../../tutorials/index.html">Tutorials</a>
            </li>
          
            <li class="">
              <a href="../../contributing/index.html">Contributing</a>
            </li>
              <li class="download"><a href="../../getting-started.html#Downloading-the-UMD-bundle">Download</a></li>
        <li class="github"><a href="https://github.com/medialize/ally.js">Github</a></li>
      </ul>
    </nav></header>
  <div id="wrapper">
    <div id="navigation-column">
        <nav id="table-of-contents"><h1>On this page</h1><ul>
        <li><a href="#Description">Description</a></li>
        
        
        <li><a href="#Usage">Usage</a></li>
        
        
        <li><a href="#Callback-signature">Callback signature</a></li>
        
        
        <li><a href="#Examples">Examples</a></li>
        
        
        <li><a href="#Changes">Changes</a></li>
        
        
        <li><a href="#Notes">Notes</a></li>
        
        
        <li><a href="#Related-resources">Related resources</a></li>
        
        
        <li><a href="#Contributing">Contributing</a></li>
        </ul></nav>
      <aside>
        <h1>Contribute to this page</h1>
        <ul id="collaboration-links">
          <li><a id="document-github-edit" href="https://github.com/medialize/ally.js/blob/master/docs/api/when/key.md">edit this page on github</a></li>
          <li><a id="document-github-issue" data-title="ally.when.key" href="https://github.com/medialize/ally.js/issues/new?title=[ally.when.key]%20_your_problem_summary_">file an issue</a></li>
          <li></li>
        
      </ul></aside>
      <aside>
        <nav id="collection-navigation">
        
          <h1>More in <em>API</em></h1><ul>
          <li class="">
            <a class="" href="../index.html">API index</a>
          </li>
          
          
          <li class="">
            <a class="" href="../concepts.html">API concepts</a>
          </li>
          
          
          <li class="">
            <a class="" href="../element/blur.html">ally.element.blur</a>
          </li>
          
          
          <li class="">
            <a class="" href="../element/disabled.html">ally.element.disabled</a>
          </li>
          
          
          <li class="">
            <a class="" href="../element/focus.html">ally.element.focus</a>
          </li>
          
          
          <li class="">
            <a class="" href="../event/active-element.html">ally.event.activeElement</a>
          </li>
          
          
          <li class="">
            <a class="" href="../event/shadow-focus.html">ally.event.shadowFocus</a>
          </li>
          
          
          <li class="">
            <a class="" href="../fix/pointer-focus-children.html">ally.fix.pointerFocusChildren</a>
          </li>
          
          
          <li class="">
            <a class="" href="../fix/pointer-focus-input.html">ally.fix.pointerFocusInput</a>
          </li>
          
          
          <li class="">
            <a class="" href="../fix/pointer-focus-parent.html">ally.fix.pointerFocusParent</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/active-element.html">ally.get.activeElement</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/active-elements.html">ally.get.activeElements</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/focus-redirect-target.html">ally.get.focusRedirectTarget</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/focus-target.html">ally.get.focusTarget</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/insignificant-branches.html">ally.get.insignificantBranches</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/parents.html">ally.get.parents</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/shadow-host.html">ally.get.shadowHost</a>
          </li>
          
          
          <li class="">
            <a class="" href="../get/shadow-host-parents.html">ally.get.shadowHostParents</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/active-element.html">ally.is.activeElement</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/disabled.html">ally.is.disabled</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/focusable.html">ally.is.focusable</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/focus-relevant.html">ally.is.focusRelevant</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/only-tabbable.html">ally.is.onlyTabbable</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/shadowed.html">ally.is.shadowed</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/tabbable.html">ally.is.tabbable</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/valid-area.html">ally.is.validArea</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/valid-tabindex.html">ally.is.validTabindex</a>
          </li>
          
          
          <li class="">
            <a class="" href="../is/visible.html">ally.is.visible</a>
          </li>
          
          
          <li class="">
            <a class="" href="../maintain/disabled.html">ally.maintain.disabled</a>
          </li>
          
          
          <li class="">
            <a class="" href="../maintain/hidden.html">ally.maintain.hidden</a>
          </li>
          
          
          <li class="">
            <a class="" href="../maintain/tab-focus.html">ally.maintain.tabFocus</a>
          </li>
          
          
          <li class="">
            <a class="" href="../map/attribute.html">ally.map.attribute</a>
          </li>
          
          
          <li class="">
            <a class="" href="../map/keycode.html">ally.map.keycode</a>
          </li>
          
          
          <li class="">
            <a class="" href="../observe/interaction-type.html">ally.observe.interactionType</a>
          </li>
          
          
          <li class="">
            <a class="" href="../observe/shadow-mutations.html">ally.observe.shadowMutations</a>
          </li>
          
          
          <li class="">
            <a class="" href="../query/first-tabbable.html">ally.query.firstTabbable</a>
          </li>
          
          
          <li class="">
            <a class="" href="../query/focusable.html">ally.query.focusable</a>
          </li>
          
          
          <li class="">
            <a class="" href="../query/shadow-hosts.html">ally.query.shadowHosts</a>
          </li>
          
          
          <li class="">
            <a class="" href="../query/tabbable.html">ally.query.tabbable</a>
          </li>
          
          
          <li class="">
            <a class="" href="../query/tabsequence.html">ally.query.tabsequence</a>
          </li>
          
          
          <li class="">
            <a class="" href="../style/focus-source.html">ally.style.focusSource</a>
          </li>
          
          
          <li class="">
            <a class="" href="../style/focus-within.html">ally.style.focusWithin</a>
          </li>
          
          
          <li class="">
            <a class="" href="focusable.html">ally.when.focusable</a>
          </li>
          
          
          <li class="active">
            <a class="" href="key.html">ally.when.key</a>
          </li>
          
          
          <li class="">
            <a class="" href="visible-area.html">ally.when.visibleArea</a>
          </li>
          
          
          <li class="">
            <a class="" href="../prototype.html">Prototype polyfills</a>
          </li>
          
          
          <li class="">
            <a class="" href="../selector.html">Selector</a>
          </li>
          
          
          <li class="">
            <a class="" href="../supports.html">Supports - Browser compatibility</a>
          </li>
          
          
          <li class="">
            <a class="" href="../util.html">Utilities</a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          </ul>
        </nav>      </aside>
    </div>

    <main id="main" tabindex="-1">
      <h1><a id="ally-when-key" href="#ally-when-key" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>ally.when.key</h1>
<p>Executes a callback when a given key has been pressed.</p>
<h2><a id="Description" href="#Description" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Description</h2>
<p>This is a convenience API to avoid adding and removing keyboard event handlers and having to filter for specific keys in application code. Callbacks are executed synchronously while handling <a href="https://developer.mozilla.org/en-US/docs/Web/Events/keydown"><code>keydown</code></a> events to maintain the ability to <a href="https://developer.mozilla.org/en/docs/Web/API/Event/preventDefault"><code>event.preventDefault()</code></a>.</p>
<p>Keyboard events are dispatched to the currently focused element (<code>document.activeElement</code>). This allows us to handle keyboard events only when the user is engaged in a particular widget.</p>
<h3><a id="Key-binding-syntax" href="#Key-binding-syntax" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Key binding syntax</h3>
<p>In order to easily register keyboard events including modifier keys, <code>ally.when.key</code> understands the following <code>&lt;key-binding&gt;</code> syntax:</p>
<table>
<thead>
<tr><th><code>&lt;key-binding&gt;</code></th><th>primary key</th><th>keyCode</th><th>alt</th><th>ctrl</th><th>meta</th><th>shift</th></tr>
</thead>
<tbody>
<tr><td><code>space</code></td><td><kbd>Space</kbd></td><td>32</td><td>no</td><td>no</td><td>no</td><td>no</td></tr>
<tr><td><code>*+space</code></td><td><kbd>Space</kbd></td><td>32</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
<tr><td><code>shift+space</code></td><td><kbd>Space</kbd></td><td>32</td><td>no</td><td>no</td><td>no</td><td>yes</td></tr>
<tr><td><code>shift+*+enter</code></td><td><kbd>Enter</kbd></td><td>13</td><td>?</td><td>?</td><td>?</td><td>yes</td></tr>
<tr><td><code>!shift+*+enter</code></td><td><kbd>Enter</kbd></td><td>13</td><td>?</td><td>?</td><td>?</td><td>no</td></tr>
<tr><td><code>?shift+ctrl+enter</code></td><td><kbd>Enter</kbd></td><td>13</td><td>no</td><td>yes</td><td>no</td><td>?</td></tr>
<tr><td><code>enter shift+8</code></td><td><kbd>Enter</kbd></td><td>13</td><td>no</td><td>no</td><td>no</td><td>no</td></tr>
<tr><td><em>(continued)</em></td><td><kbd>Backspace</kbd></td><td>8</td><td>no</td><td>no</td><td>no</td><td>yes</td></tr>
</tbody>
</table>
<p>Legend: <code>no</code> means the modifier key is not pressed, <code>yes</code> means the modifier key is pressed, <code>?</code> means the state of the modifier key is ignored.</p>
<p>The <code>&lt;key-binding&gt;</code> syntax is defined by the following <a href="https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form">EBNF</a> grammar, with <code>property of map/keycode</code> referring to the property names of <a href="../map/keycode.html"><code>ally.map.keycode</code></a>:</p>
<pre><code class="language-ebnf">token-list    = token, { &quot; &quot;, token } ;
token         = { modifier, &quot;+&quot; }, key ;
key           = named-key | keycode ;
named-key     = ? property of ally.map.keycode ? ;
keycode       = ? /[0-9]+/ ? ;
modifier      = ( [ &quot;!&quot; | &quot;?&quot; ], modifier-name ) | &quot;*&quot; ;
modifier-name = &quot;alt&quot; | &quot;ctrl&quot; | &quot;meta&quot; | &quot;shift&quot; ;
</code></pre>
<h3><a id="Modifier-keys" href="#Modifier-keys" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Modifier keys</h3>
<p>The modifier keys may have different names/symbols depending on operating system and physical keyboard:</p>
<table>
<thead>
<tr><th>modifier key name</th><th>physical key on keyboard</th></tr>
</thead>
<tbody>
<tr><td>alt</td><td><kbd>Alt</kbd>, <kbd>Option</kbd> or<kbd> &#x2325;</kbd> on Mac)</td></tr>
<tr><td>ctrl</td><td><kbd>Ctrl</kbd>, <kbd>&#x2303;</kbd> on Mac</td></tr>
<tr><td>meta</td><td><kbd>Meta</kbd>, <kbd> &#x2318;</kbd> or <kbd>&#xF8FF;</kbd> or <kbd>Command</kbd> on Mac, <kbd>&#x229E;</kbd> or <kbd>Windows</kbd> on Windows</td></tr>
<tr><td>shift</td><td><kbd>Shift</kbd>, <kbd>&#x21E7;</kbd> on Mac</td></tr>
</tbody>
</table>
<h2><a id="Usage" href="#Usage" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Usage</h2>
<pre><code class="language-javascript">var handle = ally.when.key({
  enter: function(event, disengage) {
    // react to &lt;kbd&gt;Enter&lt;/kbd&gt;
    console.log(&apos;enter pressed on&apos;, event.target);
    disengage();
  },
  32: function(event, disengage) {
    // react to &lt;kbd&gt;Space&lt;/kbd&gt;
    console.log(&apos;space pressed on&apos;, event.target);
  },
});

handle.disengage();
</code></pre>
<h3><a id="Arguments" href="#Arguments" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Arguments</h3>
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>context</td><td><a href="../concepts.html#Selector"><code>&lt;selector&gt;</code></a></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/documentElement"><code>documentElement</code></a></td><td>The scope of the DOM in which keyboard events will be processed. The first element of a collection is used.</td></tr>
<tr><td>filter</td><td><a href="../concepts.html#Selector"><code>&lt;selector&gt;</code></a></td><td><code>null</code></td><td>The elements and descendants to exclude when processing keyboard events.</td></tr>
<tr><td><a href="#Key-binding-syntax"><code>&lt;key-binding&gt;</code></a></td><td>function</td><td><em>required</em></td><td>Mapping of <code>&lt;key-binding&gt;</code> to callback function. See <a href="#Callback-Signature">Callback Signature</a> for details. This argument is expected one or more times.</td></tr>
</tbody>
</table>
<h3><a id="Returns" href="#Returns" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Returns</h3>
<p>A <a href="../concepts.html#Service"><code>&lt;service&gt;</code></a> interface, providing the <code>handle.disengage()</code> method to stop the service.</p>
<h3><a id="Throws" href="#Throws" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Throws</h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a> if no <code>&lt;key-binding&gt;: &lt;callback&gt;</code> combinations were passed.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a> if <code>&lt;key-binding&gt;</code> does not resolve to a keyCode.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a> if <code>&lt;key-binding&gt;</code> contains illegal modifier names.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a> if <code>&lt;callback&gt;</code> is not a <code>function</code>.</li>
</ul>
<h2><a id="Callback-signature" href="#Callback-signature" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Callback signature</h2>
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>event</td><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent"><code>KeyboardEvent</code></a></td><td><em>required</em></td><td>The original <code>keydown</code> event.</td></tr>
<tr><td>disengage</td><td>function</td><td><em>required</em></td><td>The service&apos;s <code>handle.disengage()</code> method.</td></tr>
</tbody>
</table>
<p>The callback is executed in the context of <code>context</code> (that&apos;s where <code>this</code> inside the callback points to). The callback is passed the <code>handle.disengage()</code> method to allow simplified &quot;execute once&quot; behaviors. The callback&apos;s return value is ignored.</p>
<h2><a id="Examples" href="#Examples" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Examples</h2>
<section class="example"><h1><a id="Example-ally-when-key-Example" href="#Example-ally-when-key-Example" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Example: ally.when.key Example</h1><a class="jsbin-embed" href="https://jsbin.com/kekuwo/embed?output">ally.when.key Example on jsbin.com</a><script src="https://static.jsbin.com/js/embed.min.js?3.35.3"></script><p><a href="https://jsbin.com/kekuwo/edit" target="_blank">play with the example on jsbin.com</a> or <a href="./key.example.html" target="_blank">open the source document</a></p></section>
<h2><a id="Changes" href="#Changes" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Changes</h2>
<ul>
<li><code>v1.1.0</code> introduced the extended <code>&lt;key-binding&gt;</code> syntax (thereby changing the default modifier key behavior).</li>
<li><code>v1.1.0</code> introduced the options <code>context</code> and <code>filter</code>.</li>
</ul>
<h2><a id="Notes" href="#Notes" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Notes</h2>
<div class="note"><strong>NOTE:</strong> Firefox has a long standing issue with keyboard events propagating to the document while browser UI like autocomplete is being interacted with <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=286933">Gecko 286933</a>.</div><div class="warning"><strong>WARNING:</strong> The callback for the <code>&lt;key-binding&gt;</code> <code>space</code> only executes if <em>no</em> modifier key was pressed. In order to make the callback execute regardless of modifier keys, use the <code>&lt;key-binding&gt;</code> <code>*+space</code>.</div><div class="note"><strong>NOTE:</strong> The modifiers <code>alt</code>, <code>ctrl</code>, <code>meta</code> usually engage system-level or browser-level functionality. Do not use these modifiers lightly. For example <code>alt+a</code> prints the letter <code>&#xE5;</code> on a Mac with German keyboard layout, <code>meta+q</code> exits the application and <code>meta+space</code> engages Spotlight.</div>
<h2><a id="Related-resources" href="#Related-resources" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Related resources</h2>
<ul>
<li><a href="../map/keycode.html"><code>ally.map.keycode</code></a> used for resolving named keys</li>
<li>The <code>&lt;key-binding&gt;</code> syntax is inspired by <a href="https://github.com/PolymerElements/iron-a11y-keys#grammar">PolymerElements/iron-a11y-keys</a></li>
</ul>
<h2><a id="Contributing" href="#Contributing" class="link-to-headline" aria-label="link to headline">&#x1F517;</a>Contributing</h2>
<ul>
<li><a href="https://github.com/medialize/ally.js/blob/master/src/when/key.js">module source</a></li>
<li><a href="https://github.com/medialize/ally.js/blob/master/docs/api/when/key.md">document source</a></li>
<li><a href="https://github.com/medialize/ally.js/blob/master/test/unit/when.key.test.js">unit test</a></li>
<li>uses <a href="https://github.com/medialize/ally.js/blob/master/src/when/key.binding.js">when/key.binding</a> to parse <code>&lt;key-binding&gt;</code></li>
</ul>

    </main>
  </div>

  <footer>
    <p>ally.js is published under the <a href="https://opensource.org/licenses/mit-license">MIT License</a>.</p>
    <p><a href="../../legal.html">Legal</a>, <a href="https://github.com/medialize/ally.js">Github</a>, <a href="https://twitter.com/allyjs_io">@allyjs_io</a>.</p>
    <p>Created By <a href="https://twitter.com/rodneyrehm">Rodney Rehm</a>.</p>
  </footer>
  <script src="../../assets/website.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js" defer></script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-8922143-6', 'auto');
    ga('send', 'pageview');
  </script></body>
</html>